<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Mod Hyper</title>
  <link rel="stylesheet" href="index.css" />

  <script async defer src="https://maps.googleapis.com/maps/api/js?key={API_KEY}&callback=initMap"></script>
</head>

<body>
  <div id="pano"></div>

  <script src="./lib/three.min.js"></script>
  <script src="./lib/GSVPano.js"></script>
  <script src="./lib/Hyperlapse.js"></script>
  <script>
    function initMap() {
      if (document.readyState !== 'complete') {
        return;
      }

      console.log('start init');
      let hyperlapse = new Hyperlapse(document.getElementById('pano'), {
        lookat: new google.maps.LatLng(37.81409525128964, -122.4775045005249),
        zoom: 1,
        use_lookat: false,
        elevation: 50,
      });

      hyperlapse.onError = function (e) {
        console.log(e);
      };

      hyperlapse.onRouteComplete = function (e) {
        hyperlapse.load();
      };

      hyperlapse.onLoadComplete = function (e) {
        hyperlapse.play();
      };

      // Google Maps API stuff here...
      let directions_service = new google.maps.DirectionsService();

      let route = {
        request: {
          origin: new google.maps.LatLng(25.038210072297254, 121.52914423832664),
          destination: new google.maps.LatLng(25.03786259637259, 121.55443828432074),
          travelMode: google.maps.DirectionsTravelMode.DRIVING,
        },
      };

      directions_service.route(route.request, function (response, status) {
        if (status == google.maps.DirectionsStatus.OK) {
          hyperlapse.generate({ route: response });
        } else {
          console.log(status);
        }
      });

    }

    window.onload = init;
  </script>
</body>

</html>